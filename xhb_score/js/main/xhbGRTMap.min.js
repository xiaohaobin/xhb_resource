const serverGoogleMapKey="AIzaSyATaepX6-wvfIawz6ZSblNd-Qv7ao3lujo";const ossGoogleMapKey="AIzaSyAJZ1r52F_6CqhNX7InHBVk8I247yJB7vM";const atessGoogleMapKey="AIzaSyAaBd71WKWCbF5Ta4EuCrmTqICWyiJ7-Pg";const otherGoogleMapKey="AIzaSyDTQQAXrXIcPb7H-tkpo2OjfqSHBIll-uM";const googleMapKey=serverGoogleMapKey;const baiduMapKey="96lMxQLD48gcNh7d6LnQZFS5S48GNk8d";const gaodeMapKey="5964d1bc26d0e26f918cf1dbb0728dd0";const gaodeJsCode="b65883329b0f0e26aeed95d9f059c62b";const sanctionCountryList=["伊朗","叙利亚","Iran","Syria"];const gaodeNodataText="高德地图只支持国内使用，查询国外地图数据请使用谷歌地图";const notSupportText="暂不支持，请重新选择";const coordTrans={PI:3.141592653589793,x_pi:3.141592653589793*3e3/180,delta:function(t,e){var a=6378245;var n=.006693421622965943;var r=this.transformLat(e-105,t-35);var o=this.transformLon(e-105,t-35);var i=t/180*this.PI;var s=Math.sin(i);s=1-n*s*s;var p=Math.sqrt(s);r=r*180/(a*(1-n)/(s*p)*this.PI);o=o*180/(a/p*Math.cos(i)*this.PI);return{lat:r,lng:o}},gcj_encrypt:function(t,e){if(this.outOfChina(t,e))return{lat:t,lng:e};var a=this.delta(t,e);return{lat:t+a.lat,lng:e+a.lng}},gcj_decrypt:function(t,e){if(this.outOfChina(t,e))return{lat:t,lng:e};var a=this.delta(t,e);return{lat:t-a.lat,lng:e-a.lng}},gcj_decrypt_exact:function(t,e){var a=.01;var n=1e-9;var r=a,o=a;var i=t-r,s=e-o;var p=t+r,l=e+o;var c,u,d=0;while(1){c=(i+p)/2;u=(s+l)/2;var h=this.gcj_encrypt(c,u);r=h.lat-t;o=h.lng-e;if(Math.abs(r)<n&&Math.abs(o)<n)break;if(r>0)p=c;else i=c;if(o>0)l=u;else s=u;if(++d>1e4)break}return{lat:c,lng:u}},bd_encrypt:function(t,e){var a=e,n=t;var r=Math.sqrt(a*a+n*n)+2e-5*Math.sin(n*this.x_pi);var o=Math.atan2(n,a)+3e-6*Math.cos(a*this.x_pi);var i=r*Math.cos(o)+.0065;var s=r*Math.sin(o)+.006;return{lat:s,lng:i}},bd_decrypt:function(t,e){var a=e-.0065,n=t-.006;var r=Math.sqrt(a*a+n*n)-2e-5*Math.sin(n*this.x_pi);var o=Math.atan2(n,a)-3e-6*Math.cos(a*this.x_pi);var i=r*Math.cos(o);var s=r*Math.sin(o);return{lat:s,lng:i}},mercator_encrypt:function(t,e){var a=e*20037508.34/180;var n=Math.log(Math.tan((90+t)*this.PI/360))/(this.PI/180);n=n*20037508.34/180;return{lat:n,lng:a}},mercator_decrypt:function(t,e){var a=e/20037508.34*180;var n=t/20037508.34*180;n=180/this.PI*(2*Math.atan(Math.exp(n*this.PI/180))-this.PI/2);return{lat:n,lng:a}},distance:function(t,e,a,n){var r=6371e3;var o=Math.cos(t*this.PI/180)*Math.cos(a*this.PI/180)*Math.cos((e-n)*this.PI/180);var i=Math.sin(t*this.PI/180)*Math.sin(a*this.PI/180);var s=o+i;if(s>1)s=1;if(s<-1)s=-1;var p=Math.acos(s);var l=p*r;return l},outOfChina:function(t,e){if(e<72.004||e>137.8347){return true}if(t<.8293||t>55.8271){return true}return false},transformLat:function(t,e){var a=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));a+=(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))*2/3;a+=(20*Math.sin(e*this.PI)+40*Math.sin(e/3*this.PI))*2/3;a+=(160*Math.sin(e/12*this.PI)+320*Math.sin(e*this.PI/30))*2/3;return a},transformLon:function(t,e){var a=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));a+=(20*Math.sin(6*t*this.PI)+20*Math.sin(2*t*this.PI))*2/3;a+=(20*Math.sin(t*this.PI)+40*Math.sin(t/3*this.PI))*2/3;a+=(150*Math.sin(t/12*this.PI)+300*Math.sin(t/30*this.PI))*2/3;return a},getWGS84:function(t,e){if(e=="google"||e=="gaode"||e=="Tencent"){return this.gcj_decrypt(t["lat"],t["lng"])}else if(e=="baidu"){var a=this.bd_decrypt(t["lat"],t["lng"]);return this.gcj_decrypt(a.lat,a.lng)}else{return t}}};function CreateChinaMapLine(){var t=[];pt1=new BMap.Point(124.326919,39.841287);t.push(pt1);pt2=new BMap.Point(124.630475,40.230192);t.push(pt2);pt3=new BMap.Point(124.980023,40.420289);t.push(pt3);pt4=new BMap.Point(125.053612,40.458947);t.push(pt4);pt5=new BMap.Point(125.028316,40.520401);t.push(pt5);pt6=new BMap.Point(125.331871,40.63438);t.push(pt6);pt7=new BMap.Point(125.456053,40.61861);t.push(pt7);pt8=new BMap.Point(126.042467,40.901897);t.push(pt8);pt9=new BMap.Point(126.888743,41.73411);t.push(pt9);pt10=new BMap.Point(127.367072,41.437131);t.push(pt10);pt11=new BMap.Point(128.148958,41.347076);t.push(pt11);pt12=new BMap.Point(128.323732,41.568524);t.push(pt12);pt13=new BMap.Point(128.112163,41.961089);t.push(pt13);pt14=new BMap.Point(128.995233,41.99541);t.push(pt14);pt15=new BMap.Point(129.418371,42.378521);t.push(pt15);pt16=new BMap.Point(129.841509,42.41943);t.push(pt16);pt17=new BMap.Point(130.080674,42.90824);t.push(pt17);pt18=new BMap.Point(130.65099,42.364879);t.push(pt18);pt19=new BMap.Point(130.503812,42.637157);t.push(pt19);pt20=new BMap.Point(131.147717,42.867653);t.push(pt20);pt21=new BMap.Point(131.313293,43.366337);t.push(pt21);pt22=new BMap.Point(131.386882,43.967324);t.push(pt22);pt23=new BMap.Point(131.202909,44.798523);t.push(pt23);pt24=new BMap.Point(131.938801,45.190155);t.push(pt24);pt25=new BMap.Point(133.024241,44.916296);t.push(pt25);pt26=new BMap.Point(134.385641,47.183241);t.push(pt26);pt27=new BMap.Point(134.845574,47.670159);t.push(pt27);pt28=new BMap.Point(134.73519,48.066299);t.push(pt28);pt29=new BMap.Point(135.250314,48.434915);t.push(pt29);pt30=new BMap.Point(133.079433,48.115602);t.push(pt30);pt31=new BMap.Point(132.453925,47.76948);t.push(pt31);pt32=new BMap.Point(131.221306,47.707427);t.push(pt32);pt33=new BMap.Point(130.85336,48.078629);t.push(pt33);pt34=new BMap.Point(130.908552,48.825163);t.push(pt34);pt35=new BMap.Point(128.093766,49.632427);t.push(pt35);pt36=new BMap.Point(125.830898,53.063643);t.push(pt36);pt37=new BMap.Point(123.420852,53.60326);t.push(pt37);pt38=new BMap.Point(120.661258,53.240599);t.push(pt38);pt39=new BMap.Point(119.906969,52.584436);t.push(pt39);pt40=new BMap.Point(120.698052,52.494695);t.push(pt40);pt41=new BMap.Point(120.734847,52.05456);t.push(pt41);pt42=new BMap.Point(119.023898,50.296998);t.push(pt42);pt43=new BMap.Point(119.263063,50.143545);t.push(pt43);pt44=new BMap.Point(117.956855,49.560675);t.push(pt44);pt45=new BMap.Point(116.889812,49.858941);t.push(pt45);pt46=new BMap.Point(115.47322,48.078629);t.push(pt46);pt47=new BMap.Point(115.988344,47.607987);t.push(pt47);pt48=new BMap.Point(116.797825,47.76948);t.push(pt48);pt49=new BMap.Point(117.349744,47.520821);t.push(pt49);pt50=new BMap.Point(117.901663,47.905734);t.push(pt50);pt51=new BMap.Point(118.508774,47.893363);t.push(pt51);pt52=new BMap.Point(118.545569,47.86861);t.push(pt52);pt53=new BMap.Point(119.888571,46.843488);t.push(pt53);pt54=new BMap.Point(119.796585,46.590415);t.push(pt54);pt55=new BMap.Point(119.005501,46.717101);t.push(pt55);pt56=new BMap.Point(117.791279,46.526961);t.push(pt56);pt57=new BMap.Point(117.404936,46.310656);t.push(pt57);pt58=new BMap.Point(116.797825,46.323404);t.push(pt58);pt59=new BMap.Point(116.282701,45.798295);t.push(pt59);pt60=new BMap.Point(114.700534,45.384961);t.push(pt60);pt61=new BMap.Point(113.670285,44.759212);t.push(pt61);pt62=new BMap.Point(112.161707,45.04687);t.push(pt62);pt63=new BMap.Point(111.444212,44.298587);t.push(pt63);pt64=new BMap.Point(111.959336,43.767669);t.push(pt64);pt65=new BMap.Point(110.082812,42.569199);t.push(pt65);pt66=new BMap.Point(107.543985,42.39216);t.push(pt66);pt67=new BMap.Point(105.115542,41.609961);t.push(pt67);pt68=new BMap.Point(100.405834,42.596391);t.push(pt68);pt69=new BMap.Point(96.560799,42.772848);t.push(pt69);pt70=new BMap.Point(91.188788,45.203163);t.push(pt70);pt71=new BMap.Point(89.992964,47.893363);t.push(pt71);pt72=new BMap.Point(87.969261,49.115857);t.push(pt72);pt73=new BMap.Point(86.847026,49.055436);t.push(pt73);pt74=new BMap.Point(85.724791,48.201769);t.push(pt74);pt75=new BMap.Point(85.301653,47.05766);t.push(pt75);pt76=new BMap.Point(83.167567,47.23339);t.push(pt76);pt77=new BMap.Point(82.284497,45.52739);t.push(pt77);pt78=new BMap.Point(82.652442,45.177144);t.push(pt78);pt79=new BMap.Point(81.769372,45.346053);t.push(pt79);pt80=new BMap.Point(79.911245,44.890145);t.push(pt80);pt81=new BMap.Point(80.702329,43.20505);t.push(pt81);pt82=new BMap.Point(80.003232,42.077702);t.push(pt82);pt83=new BMap.Point(77.096459,41.05527);t.push(pt83);pt84=new BMap.Point(76.158197,40.369298);t.push(pt84);pt85=new BMap.Point(75.753456,40.594072);t.push(pt85);pt86=new BMap.Point(74.925578,40.48178);t.push(pt86);pt87=new BMap.Point(73.803343,39.605094);t.push(pt87);pt88=new BMap.Point(73.637767,39.291284);t.push(pt88);pt89=new BMap.Point(73.913726,38.457149);t.push(pt89);pt90=new BMap.Point(74.612824,38.500536);t.push(pt90);pt91=new BMap.Point(74.999167,37.31988);t.push(pt91);pt92=new BMap.Point(77.924337,35.325072);t.push(pt92);pt93=new BMap.Point(78.273886,34.598061);t.push(pt93);pt94=new BMap.Point(79.101764,34.293224);t.push(pt94);pt95=new BMap.Point(78.770613,33.987267);t.push(pt95);pt96=new BMap.Point(79.230545,32.472038);t.push(pt96);pt97=new BMap.Point(78.880997,32.59672);t.push(pt97);pt98=new BMap.Point(78.421064,32.425237);t.push(pt98);pt99=new BMap.Point(78.844202,31.18404);t.push(pt99);pt100=new BMap.Point(81.180659,29.990271);t.push(pt100);pt101=new BMap.Point(81.71418,30.34198);t.push(pt101);pt102=new BMap.Point(86.092737,27.935542);t.push(pt102);pt103=new BMap.Point(88.760345,27.951881);t.push(pt103);pt104=new BMap.Point(88.99951,27.197728);t.push(pt104);pt105=new BMap.Point(89.845786,28.098817);t.push(pt105);pt106=new BMap.Point(91.538337,27.772017);t.push(pt106);pt107=new BMap.Point(92.108653,26.769165);t.push(pt107);pt108=new BMap.Point(93.893191,26.851709);t.push(pt108);pt109=new BMap.Point(95.916893,28.115131);t.push(pt109);pt110=new BMap.Point(97.223102,27.690161);t.push(pt110);pt111=new BMap.Point(97.609445,28.375809);t.push(pt111);pt112=new BMap.Point(98.363734,27.427807);t.push(pt112);pt113=new BMap.Point(98.73168,26.653501);t.push(pt113);pt114=new BMap.Point(97.646239,24.702995);t.push(pt114);pt115=new BMap.Point(97.627842,23.842845);t.push(pt115);pt116=new BMap.Point(98.658091,23.944344);t.push(pt116);pt117=new BMap.Point(98.970845,23.045009);t.push(pt117);pt118=new BMap.Point(99.449174,22.89168);t.push(pt118);pt119=new BMap.Point(99.21001,21.96805);t.push(pt119);pt120=new BMap.Point(99.982696,21.933723);t.push(pt120);pt121=new BMap.Point(100.166669,21.366121);t.push(pt121);pt122=new BMap.Point(101.086534,21.589991);t.push(pt122);pt123=new BMap.Point(101.730439,21.055576);t.push(pt123);pt124=new BMap.Point(101.969604,21.31441);t.push(pt124);pt125=new BMap.Point(101.804028,22.190972);t.push(pt125);pt126=new BMap.Point(102.53992,22.53323);t.push(pt126);pt127=new BMap.Point(103.956512,22.447745);t.push(pt127);pt128=new BMap.Point(105.465091,23.130116);t.push(pt128);pt129=new BMap.Point(107.819945,21.435041);t.push(pt129);pt130=new BMap.Point(108.408658,20.588528);t.push(pt130);pt131=new BMap.Point(108.243082,17.791978);t.push(pt131);pt132=new BMap.Point(110.101209,14.556493);t.push(pt132);pt133=new BMap.Point(109.82525,10.162358);t.push(pt133);pt134=new BMap.Point(108.151096,6.074665);t.push(pt134);pt135=new BMap.Point(109.604482,3.416913);t.push(pt135);pt136=new BMap.Point(113.136763,3.712694);t.push(pt136);pt137=new BMap.Point(115.362836,6.737258);t.push(pt137);pt138=new BMap.Point(117.404936,9.505473);t.push(pt138);pt139=new BMap.Point(119.318255,14.574413);t.push(pt139);pt140=new BMap.Point(120.164531,19.12633);t.push(pt140);pt141=new BMap.Point(122.059452,21.693198);t.push(pt141);pt142=new BMap.Point(122.813741,24.686186);t.push(pt142);pt143=new BMap.Point(124.230333,28.457139);t.push(pt143);pt144=new BMap.Point(124.855841,32.721228);t.push(pt144);pt145=new BMap.Point(124.230333,36.56674);t.push(pt145);pt146=new BMap.Point(124.487895,39.59086);t.push(pt146);return t}function getLatLngInfoByBDWebServer(t,e){t.location=t.location.lat+","+t.location.lng;var a={ak:"zkUzSPYaHb7Uhr5ofn32GuPrSCZGjbnW",output:"json",coordtype:"wgs84ll",location:""};var n=Object.assign({},a,t);jsonp({url:"https://api.map.baidu.com/reverse_geocoding/v3",data:n,success:function(t){e&&e(t.result)}})}function getLatLngInfoByGDWebServer(t,e){t.location=t.location.lng+","+t.location.lat;var a={key:"74534047360c79e9a712cf1590fed66b",output:"json",location:""};var n=Object.assign({},a,t);jsonp({url:"https://restapi.amap.com/v3/geocode/regeo",data:n,success:function(t){if(t.regeocode.addressComponent.country.length===0){t.info="error"}e&&e(t)}})}function jsonp(t){const e=document.createElement("script");let a=Math.random().toString();a=a.replace(".","_");let n=Math.random().toString();n=n.replace(".","_");const r=`fun${a}_${n}`;let o="";for(const s in t.data){o+="&"+s+"="+t.data[s]}e.src=`${t.url}?callback=${r}`+o;window[r]=t.success;const i=document.querySelector("body");i.appendChild(e);e.addEventListener("load",()=>i.removeChild(e))}const promiseAjax=function(r){return new Promise((e,a)=>{let n=null;if(window.XMLHttpRequest){n=new XMLHttpRequest}else{n=new ActiveXObject("Microsoft.XMLHTTP")}n.onreadystatechange=function(){try{if(n.readyState==4&&n.status==200){var t=typeof this.responseText=="object"?this.responseText:JSON.parse(this.responseText);e(t)}else{if(n.status==404)throw"404,未找到页面"}}catch(t){a(t)}};if(r.methods!=undefined&&r.methods!=""){var t=String(r.methods).toUpperCase;if(t=="GET"){let e="?";for(let t in r.data){e+=t+"="+r.data[t]+"&"}e.substring(e.length-1);r.data=e}}else{throw new Error("请求方式不能为空！")}n.open(r.methods,r.url,true);t=="GET"?n.send():n.send(r.data)})};function getLatLogByLocalhost(n){var r={lat:22.581783001,lng:113.962135001};if(!navigator.geolocation){n&&n(r)}else{navigator.geolocation.getCurrentPosition(function(t){var e=t.coords.latitude;var a=t.coords.longitude;r={lat:e,lng:a};n&&n(r)},function(){n&&n(r)},{timeout:1e4})}}function loadScript(e,a,n){var t=this;var r=document.createElement("script");r.type="text/javascript";if(r.readystate){r.onreadystatechange=function(){if(r.readyState=="loaded"||r.readyState=="complete"){if(a==e.length-1){n()}else{loadScript(e,a+1,n)}r.onreadystatechange=null}}}else{r.onload=function(t){if(a==e.length-1){n()}else{loadScript(e,a+1,n)}}}r.src=e[a];document.body.appendChild(r)}(function(l){"use strict";var t;function o(){}o.prototype.navigationControl=function(){var t=new BMap.NavigationControl({anchor:BMAP_ANCHOR_BOTTOM_RIGHT,offset:new BMap.Size(10,150),type:BMAP_NAVIGATION_CONTROL_LARGE,showZoomInfo:true,enableGeolocation:true});return t};o.prototype.geolocationControl=function(e,a){var t=new BMap.GeolocationControl({anchor:BMAP_ANCHOR_BOTTOM_LEFT,offset:new BMap.Size(10,80),showAddressBar:true,enableGeolocation:true});t.addEventListener("locationSuccess",function(t){e(t.addressComponent,t.point)});t.addEventListener("locationError",function(t){a(t.message)});return t};o.prototype.scaleControl=function(){var t=new BMap.ScaleControl({anchor:BMAP_ANCHOR_TOP_RIGHT,offset:new BMap.Size(10,10)});return t};o.prototype.mapTypeControl=function(){var t={anchor:BMAP_ANCHOR_TOP_RIGHT,type:BMAP_MAPTYPE_CONTROL_MAP};var e=new BMap.MapTypeControl(t);return e};o.prototype.panoramaControl=function(){var t=new BMap.PanoramaControl({anchor:BMAP_ANCHOR_TOP_RIGHT});return t};o.prototype.removeMarker=function(t,e){var a=map.getOverlays();for(var n=0;n<a.length;n++){if(a[n].toString()=="[object Marker]"){if(a[n].getPosition().lng==t&&a[n].getPosition().lat==e){map.removeOverlay(a[n])}}}};o.prototype.transfrom=function(t,e,a){var n=new BMap.Point(t,e);var r=function(t){if(t.status===0)a(t.points[0])};var o=new BMap.Convertor;var i=[];i.push(n);o.translate(i,1,5,r)};o.prototype.getDistence=function(t,e,a,n){var r=new BMap.Point(t*1,e*1);var o=new BMap.Point(a*1,n*1);return Math.ceil(map.getDistance(r,o))};o.prototype.setLabel=function(t){var e=this;var a={content:"这是标注的label",offset:[15,-15],style:{border:"solid 1px gray",padding:"2px 5px",borderRadius:"3px"}};var n=Object.assign({},a,t);var r=new BMap.Label(n.content,{offset:new BMap.Size(n.offset[0],n.offset[1])});r.setStyle(n.style);return r};o.prototype.createMarker=function(t){var e=this;var a={Icon:e.setIcon(),lng:113.95403656908,lat:22.549744538467};var n=Object.assign({},a,t);var r=new BMap.Point(n.lng,n.lat);var o=new BMap.Marker(r,{icon:n.Icon});return o};o.prototype.setIcon=function(t){var e={imgUrl:"http://api0.map.bdimg.com/images/marker_red_sprite.png",width:39,height:25};var a=Object.assign({},e,t);var n=new BMap.Icon(a.imgUrl,new BMap.Size(a.width,a.height));return n};o.prototype.setWindow=function(t){var e={content:"这特么是信息窗口内容！....",width:200,height:200,title:"信息窗口标题"};var a=Object.assign({},e,t);var n=new BMap.InfoWindow(a.content,{width:a.width,height:a.height,title:a.title});return n};o.prototype.setContextMenu=function(t){var e={ContextMenu:[{text:"打印",callback:function(t,e,a){}},{text:"删除",callback:function(t,e,a){map.removeOverlay(a)}}]};var a=Object.assign({},e,t);var n=new BMap.ContextMenu;for(var r in a.ContextMenu){n.addItem(new BMap.MenuItem(a.ContextMenu[r].text,a.ContextMenu[r].callback))}return n};function e(t){var e=this;var a={lat:22.581783,lng:113.962135,idVal:"baiduMap",oAddressInput:false,isStillMarker:false,isModuleLoad:false,isPlaceSugSearch:false,mapKey:baiduMapKey,callback:function(){}};const n=Object.assign({},a,t);this.firstLat=n.lat;this.firstLng=n.lng;this.firstAddr="";this.callback=n.callback;this.lat=n.lat;this.lng=n.lng;this.mapKey=n.mapKey;this.idVal=n.idVal;this.oAddressInput=n.oAddressInput;this.isStillMarker=n.isStillMarker;this.isPlaceSugSearch=n.isPlaceSugSearch;this.mapControl=null;this.isChina=true;this.postal_code="";this.detailsAddress="";this.city="";this.country="";this.provice="";this.map=null;this.infowindow=null;this.geocoder=null;this.marker=null;this.oAutocomplete=null;this.placeSugSearchMarker=null;this.markerClusterer=null;this.clustererMarkerList=[];this.localSearch=null;this.BMapLib=null;if(n.isModuleLoad){e.renderMap(e.lat,e.lng,e.idVal,function(){})}else{this.xhbLoadGMap({lat:this.lat,lng:this.lng},this.idVal)}}e.prototype.xhbLoadGMap=function(t,e,a){var n=this;var r=Date.parse(new Date);var o=[location.protocol+"//api.map.baidu.com/getscript?v=2.0&ak="+this.mapKey+"&services=&t="+r];if(window.BMap){n.renderMap(n.lat,n.lng,n.idVal,function(){})}else{loadScript(o,0,function(){n.renderMap(n.lat,n.lng,n.idVal,function(){})})}};e.prototype.renderMap=function(t,e,a,n){var r=this;this.map=new BMap.Map(a);this.map.enableScrollWheelZoom(true);this.localSearch=new BMap.LocalSearch(this.map);this.mapControl=new o;this.geocoder=new BMap.Geocoder;this.map.addControl(this.mapControl.navigationControl());this.mapControl.transfrom(e,t,function(t){r.marker=r.mapControl.createMarker({lng:t.lng,lat:t.lat});r.map.addOverlay(r.marker);if(!r.isStillMarker){r.marker.enableDragging()}r.map.centerAndZoom(r.marker.getPosition(),17);r.getInfoByLatLng(r.marker.getPosition(),function(t){r.firstAddr=r.detailsAddress});r.marker.addEventListener("dragend",function(t){var e=t.point;r.map.centerAndZoom(e,17);var a=this;r.getInfoByLatLng(e,function(t){})});r.callback()});if(this.oAddressInput){if(this.isPlaceSugSearch){this.placeSugSearch(this.oAddressInput,true)}else{this.oAddressInput.onblur=function(){var e=this.value;if(e=="")return false;r.sanctionCountry(e,function(t){if(!t){r.localSearchFn(e,function(){})}})}}}n&&n()};e.prototype.updateMarkerLabelContent=function(t){var e=this;if(t)e.detailsAddress=t;if(e.marker.getLabel()){e.marker.getLabel().setContent(e.detailsAddress)}else{e.marker.setLabel(e._setLabel(e.detailsAddress))}if(e.oAddressInput){e.oAddressInput.value=e.detailsAddress}if(this.oAutocomplete)this.oAutocomplete.hide()};e.prototype.initMarkerClusterer=function(t,e,a,n){var r=this;loadScript(["https://api.map.baidu.com/library/TextIconOverlay/1.2/src/TextIconOverlay_min.js"],0,function(){r.initMarkerClusterer2(t,e,a,n)})};e.prototype.initMarkerClusterer2=function(t,r,o,n){var i=this;this.coordinateTrans(t,1,5,function(t){const e=t.map(function(t,a){const n=i.mapControl.createMarker({lng:t.lng,lat:t.lat});n.setLabel(i._setLabel(r[a]));n.addEventListener("click",(t,e)=>{o&&o(a,t,n)});i.clustererMarkerList.push(n);return n});const a=new BMap.Point(t[0].lng,t[0].lat);i.map.centerAndZoom(a,2);if(window.BMapLib){i.markerClusterer=new BMapLib.MarkerClusterer(i.map,{markers:e,minClusterSize:2})}else{if(n){i.markerClusterer=new n.MarkerClusterer(i.map,{markers:e,minClusterSize:2})}else{alert("请引入百度地图标注聚合功能插件脚本才能使用标注聚合功能")}}})};e.prototype.addMarkerClusterer=function(t,n,r){if(!this.markerClusterer){return alert("请先使用 initMarkerClusterer 函数初始化标注聚合器功能")}var o=this;this.coordinateTrans(t,1,5,function(t){const e=t.map(function(t,a){const e=o.mapControl.createMarker({lng:t.lng,lat:t.lat});e.setLabel(o._setLabel(n[a]));e.addEventListener("click",(t,e)=>{r&&r(a,t)});o.clustererMarkerList.push(e);return e});o.markerClusterer.addMarkers(e);const a=new BMap.Point(t[0].lng,t[0].lat);o.map.centerAndZoom(a,2)})};e.prototype.updateMarkerClusterer=function(t,e,a){this.markerClusterer.clearMarkers();this.clustererMarkerList=[];this.addMarkerClusterer(t,e,a)};e.prototype.delMarkerClusterer=function(t){if(this.clustererMarkerList.length&&this.markerClusterer){this.markerClusterer.removeMarker(this.clustererMarkerList[t]);this.clustererMarkerList.splice(t,1)}};e.prototype.localSearchFn=function(a){if(a==this.detailsAddress)return;var n=this;this.localSearch.setSearchCompleteCallback(function(t){var e=t.getPoi(0);n.getInfoByLatLng(e.point,function(){n.updateMarkerLabelContent(a)})});this.localSearch.search(a)};e.prototype.getInfoByLatLng=function(n,r){var o=this;this.geocoder.getLocation(n,function(a,t){if(!a&&!t){return o.getInfoByLatLng(n,r)}o.sanctionCountry(a.address,function(t){if(t)return;var e=a.addressComponents;o.city=e.city;o.provice=e.province;o.detailsAddress=e.province+e.city+e.district+e.street+e.streetNumber;var t=o.setChinaAreaByLnglat(n,o.detailsAddress);o.lat=n.lat;o.lng=n.lng;o.map.centerAndZoom(n,17);o.marker.setPosition(n);o.updateMarkerLabelContent(o.detailsAddress);r(a)})})};e.prototype.setChinaAreaByLnglat=function(t,e){var a=this;var n=this.isBaiduPointOnChina(t.lng,t.lat);a.country=n?"中国":"";if(e==""){a.detailsAddress=n?"中国境内":"未知区域"}return n};e.prototype.updateMarkerWindow=function(a,t,e){var n=this;if(!this.marker||!this.geocoder){window.updateMarkerWindow_fn_timer=setTimeout(function(){n.updateMarkerWindow(a,t,e)},1e3)}else{window.clearTimeout(window.updateMarkerWindow_fn_timer);n.lat=t;n.lng=e;this.mapControl.transfrom(e,t,function(t){var e=new BMap.Point(t.lng,t.lat);n.getInfoByLatLng(e,function(t){n.updateMarkerLabelContent(a||n.detailsAddress)})})}};e.prototype._setLabel=function(t){var e=this.mapControl.setLabel({content:t||"搜索中...",offset:[15,-15],style:{border:"1px solid gray",padding:"2px 5px",borderRadius:"3px"}});return e};e.prototype.getStaticMapImage=function(t,e){t=t||this.lat;e=e||this.lng;var a="https://api.map.baidu.com/staticimage/v2?ak="+this.mapKey+"&center="+e+","+t+"&width=1000&height=1000&zoom=17";return a};e.prototype.sanctionCountry=function(t,n){var r=this;var e=false;for(var a=0;a<sanctionCountryList.length;a++){if(t.indexOf(sanctionCountryList[a])>=0){e=true}}if(e){this.getLnglatByAddress(t,function(t){if(t.info=="OK"){var e=t.lnglat;var a=r.isBaiduPointOnChina(e.lng,e.lat);if(!a){r.updateMarkerWindow(r.firstAddr,r.firstLat,r.firstLng);if(window.layer){layer.msg(notSupportText)}else{alert(notSupportText)}}n&&n(!a)}else{console.error("地址解析失败");n&&n(false)}})}else{n&&n(false)}};e.prototype.getLnglatByAddress=function(t,r){var e=this;this.localSearch.search(t);this.localSearch.setSearchCompleteCallback(function(t,e){var a=t.getPoi(0);if(a&&a.point){var n={lnglat:a.point,info:"OK"}}else{var n={lnglat:a,info:"error"}}r&&r(n)})};e.prototype.getPlaceSuggestionList=function(t,e){var a=this;var n={ak:"zkUzSPYaHb7Uhr5ofn32GuPrSCZGjbnW",query:"",region:"",city_limit:false,output:"json"};const r=Object.assign({},n,t);jsonp({url:"https://api.map.baidu.com/place/v2/suggestion",data:r,success:function(t){e&&e(t)}})};e.prototype.initLocalCity=function(e){var t=this;var a=new BMap.LocalCity;a.get(function(t){e&&e(t)})},e.prototype.searchByKey=function(o,i,s){var p=this;if(window.baiduMap_searchByKey_loadCount===l)window.baiduMap_searchByKey_loadCount=0;if(this.oAutocomplete)this.oAutocomplete.hide();var t=i.district;var e=i.street;var a=i.streetNumber;var n=i.business;p.provice=i.province;p.city=i.city;var r=new BMap.LocalSearch(o);r.enableAutoViewport();r.search(i.business);r.setSearchCompleteCallback(function(t){if(t&&t.getPoi(0)){var e=t.getPoi(0);if(e.point){var a=p.isBaiduPointOnChina(e.point.lng,e.point.lat);var n=e.address==e.title?"":"【"+e.title+"】";p.detailsAddress=n+e.address;if(!a){p.sanctionCountry(p.detailsAddress,function(t){if(!t)r()})}else{r()}function r(){o.centerAndZoom(e.point,17);s.setPosition(e.point);var t=p.setChinaAreaByLnglat(e.point,p.detailsAddress);p.lat=e.point.lat;p.lng=e.point.lng;if(p.oAddressInput){p.oAddressInput.value=p.detailsAddress}if(p.oAutocomplete)p.oAutocomplete.hide();s.getLabel().setContent(p.detailsAddress);window.baiduMap_searchByKey=null;window.clearTimeout(window.baiduMap_searchByKey);p.map.enableDragging();p.marker.enableDragging();p.oAddressInput.removeAttribute("disabled")}}}else{p.oAddressInput.value="百度地图搜索关键字位置中，请勿操作......";if(p.oAutocomplete)p.oAutocomplete.hide();p.map.disableDragging();p.marker.disableDragging();p.oAddressInput.setAttribute("disabled","disabled");window.baiduMap_searchByKey_loadCount++;if(window.baiduMap_searchByKey_loadCount===3){window.baiduMap_searchByKey_loadCount=0;window.baiduMap_searchByKey=null;window.clearTimeout(window.baiduMap_searchByKey);p.getPlaceSuggestionList({query:i.business,city_limit:true,region:i.city},function(t){p.map.enableDragging();p.marker.enableDragging();p.oAddressInput.removeAttribute("disabled");var e=t.results||t.result;if(e.length){var a=new BMap.Point(e[0].location.lng,e[0].location.lat);p.getInfoByLatLng(a,function(t){p.updateMarkerLabelContent(e[0].address)})}else{console.error("无法精准定位,请使用百度地图web 服务进行查询，查询字段:"+i.business,t);p.oAddressInput.value=p.detailsAddress}if(p.oAutocomplete)p.oAutocomplete.hide()});return}window.baiduMap_searchByKey=window.setTimeout(function(){p.searchByKey(o,i,s)},500)}})};e.prototype.getPoint=function(t,a){this.geocoder.getPoint(t,function(t){if(t){var e={lnglat:t,info:"OK"}}else{var e={info:"error"}}a&&a(e)})};e.prototype.placeSugSearch=function(t,n){var r=this;this.oAutocomplete=new BMap.Autocomplete({input:t.getAttribute("id"),location:this.map});this.oAutocomplete.addEventListener("onconfirm",function(t,e){var a=t.item.value;if(n){r.searchByKey(r.map,a,r.marker)}else{r.addPlaceSugSearchMarker(a)}});this.oAutocomplete.hide()};e.prototype.addPlaceSugSearchMarker=function(t){var a=this;var e=t.district;var n=t.street;var r=t.streetNumber;var o=t.business;var i=t.province;var s=t.city;var p=i+s+e+n+r+o;var l=new BMap.LocalSearch(this.map);l.enableAutoViewport();l.search(p);l.setSearchCompleteCallback(function(t){if(t&&t.getPoi(0)){var e=t.getPoi(0);if(e.point){a.map.centerAndZoom(e.point,17);if(a.placeSugSearchMarker){a.placeSugSearchMarker.setPosition(e.point);a.placeSugSearchMarker.getLabel().setContent(p)}else{a.placeSugSearchMarker=a.mapControl.createMarker({lng:e.point.lng,lat:e.point.lat});a.map.addOverlay(a.placeSugSearchMarker);a.placeSugSearchMarker.setLabel(a._setLabel(p))}}}})};e.prototype.searchDataByTag=function(t,e){var a=this;var n={ak:"zkUzSPYaHb7Uhr5ofn32GuPrSCZGjbnW",query:t.query||"",tag:"",region:"",city_limit:false,output:"json"};const r=Object.assign({},n,t);jsonp({url:"https://api.map.baidu.com/place/v2/search",data:r,success:function(t){e&&e(t)}})};e.prototype.getipaddress=function(e){jsonp({url:"https://api.map.baidu.com/location/ip",data:{ak:this.mapKey,coor:"WGS84ll"},success:function(t){e&&e(t)}})};e.prototype.coordinateTrans=function(t,n,r,e){var a=this;window.coordinateTransTimer=null;if(!window.BMap){window.coordinateTransTimer=setTimeout(function(){a.coordinateTrans(t,n,r,e)},800);return}else{clearTimeout(window.coordinateTransTimer)}var s={i:0,groups:[],arr:[],init:function(t){var e=0;var a=0;if(t.length%10>0){a=t.length/10+1}else{a=t.length/10}for(var n=0;n<a;n++){var r=[];for(var o=0;o<10;o++){if(e<t.length){var i=new BMap.Point(t[n*10+o].lng,t[n*10+o].lat);r.push(i)}e++}s.groups.push(r)}},start:function(a){if(s.i<s.groups.length){var t=s.groups[s.i];if(t.length>0){var e=new BMap.Convertor;e.translate(t,n,r,function(t){for(var e=0;e<t.points.length;e++){s.arr.push(t.points[e])}s.i++;s.start(a)})}else{s.i++;s.start(a)}}else{a(s.arr)}}};s.init(t);s.start(function(t){e&&e(t)})};e.prototype.getCurrCoordByWGS84=function(t,e){t=t||this.lat;e=e||this.lng;return coordTrans.getWGS84({lat:t,lng:e},"baidu")};e.prototype.getOnChina=function(){var t=window.BMapLib=t||{};var R=6370996.81;var s=t.GeoUtils=function(){};s.isPointInRect=function(t,e){if(!(t instanceof BMap.Point)||!(e instanceof BMap.Bounds)){return false}var a=e.getSouthWest();var n=e.getNorthEast();return t.lng>=a.lng&&t.lng<=n.lng&&t.lat>=a.lat&&t.lat<=n.lat};s.isPointInCircle=function(t,e){if(!(t instanceof BMap.Point)||!(e instanceof BMap.Circle)){return false}var a=e.getCenter();var n=e.getRadius();var r=s.getDistance(t,a);if(r<=n){return true}else{return false}};s.isPointOnPolyline=function(t,e){if(!(t instanceof BMap.Point)||!(e instanceof BMap.Polyline)){return false}var a=e.getBounds();if(!this.isPointInRect(t,a)){return false}var n=e.getPath();for(var r=0;r<n.length-1;r++){var o=n[r];var i=n[r+1];if(t.lng>=Math.min(o.lng,i.lng)&&t.lng<=Math.max(o.lng,i.lng)&&t.lat>=Math.min(o.lat,i.lat)&&t.lat<=Math.max(o.lat,i.lat)){var s=(o.lng-t.lng)*(i.lat-t.lat)-(i.lng-t.lng)*(o.lat-t.lat);if(s<2e-10&&s>-2e-10){return true}}}return false};s.isPointInPolygon=function(t,e){if(!(t instanceof BMap.Point)||!(e instanceof BMap.Polygon)){return false}var a=e.getBounds();if(!this.isPointInRect(t,a)){return false}var n=e.getPath();var r=n.length;var o=true;var i=0;var s=2e-10;var p,l;var c=t;p=n[0];for(var u=1;u<=r;++u){if(c.equals(p)){return o}l=n[u%r];if(c.lat<Math.min(p.lat,l.lat)||c.lat>Math.max(p.lat,l.lat)){p=l;continue}if(c.lat>Math.min(p.lat,l.lat)&&c.lat<Math.max(p.lat,l.lat)){if(c.lng<=Math.max(p.lng,l.lng)){if(p.lat==l.lat&&c.lng>=Math.min(p.lng,l.lng)){return o}if(p.lng==l.lng){if(p.lng==c.lng){return o}else{++i}}else{var d=(c.lat-p.lat)*(l.lng-p.lng)/(l.lat-p.lat)+p.lng;if(Math.abs(c.lng-d)<s){return o}if(c.lng<d){++i}}}}else{if(c.lat==l.lat&&c.lng<=l.lng){var h=n[(u+1)%r];if(c.lat>=Math.min(p.lat,h.lat)&&c.lat<=Math.max(p.lat,h.lat)){++i}else{i+=2}}}p=l}if(i%2==0){return false}else{return true}};s.degreeToRad=function(t){return Math.PI*t/180};s.radToDegree=function(t){return 180*t/Math.PI};function i(t,e,a){if(e!=null){t=Math.max(t,e)}if(a!=null){t=Math.min(t,a)}return t}function p(t,e,a){while(t>a){t-=a-e}while(t<e){t+=a-e}return t}s.getDistance=function(t,e){if(!(t instanceof BMap.Point)||!(e instanceof BMap.Point)){return 0}t.lng=p(t.lng,-180,180);t.lat=i(t.lat,-74,74);e.lng=p(e.lng,-180,180);e.lat=i(e.lat,-74,74);var a,n,r,o;a=s.degreeToRad(t.lng);r=s.degreeToRad(t.lat);n=s.degreeToRad(e.lng);o=s.degreeToRad(e.lat);return R*Math.acos(Math.sin(r)*Math.sin(o)+Math.cos(r)*Math.cos(o)*Math.cos(n-a))};s.getPolylineDistance=function(t){if(t instanceof BMap.Polyline||t instanceof Array){var e;if(t instanceof BMap.Polyline){e=t.getPath()}else{e=t}if(e.length<2){return 0}var a=0;for(var n=0;n<e.length-1;n++){var r=e[n];var o=e[n+1];var i=s.getDistance(r,o);a+=i}return a}else{return 0}};s.getPolygonArea=function(t){if(!(t instanceof BMap.Polygon)&&!(t instanceof Array)){return 0}var e;if(t instanceof BMap.Polygon){e=t.getPath()}else{e=t}if(e.length<3){return 0}var a=0;var n=0;var r=0;var o=0;var i=0;var s=0;var p=0;var l=0;var c=0;var u=0;var d=0;var h=0;var g=0;var f=0;var M=0;var v=0;var m=0;var y=0;var w=0;var P=0;var B=0;var k=0;var S=0;var L=0;var C=0;var G=0;var W=0;var A=0;var b=0;var I=0;var x=0;var D=0;var E=0;var _=0;var z=R;var O=e.length;for(var T=0;T<O;T++){if(T==0){n=e[O-1].lng*Math.PI/180;r=e[O-1].lat*Math.PI/180;o=e[0].lng*Math.PI/180;i=e[0].lat*Math.PI/180;s=e[1].lng*Math.PI/180;p=e[1].lat*Math.PI/180}else{if(T==O-1){n=e[O-2].lng*Math.PI/180;r=e[O-2].lat*Math.PI/180;o=e[O-1].lng*Math.PI/180;i=e[O-1].lat*Math.PI/180;s=e[0].lng*Math.PI/180;p=e[0].lat*Math.PI/180}else{n=e[T-1].lng*Math.PI/180;r=e[T-1].lat*Math.PI/180;o=e[T].lng*Math.PI/180;i=e[T].lat*Math.PI/180;s=e[T+1].lng*Math.PI/180;p=e[T+1].lat*Math.PI/180}}l=Math.cos(i)*Math.cos(o);c=Math.cos(i)*Math.sin(o);u=Math.sin(i);d=Math.cos(r)*Math.cos(n);h=Math.cos(r)*Math.sin(n);g=Math.sin(r);f=Math.cos(p)*Math.cos(s);M=Math.cos(p)*Math.sin(s);v=Math.sin(p);m=(l*l+c*c+u*u)/(l*d+c*h+u*g);y=(l*l+c*c+u*u)/(l*f+c*M+u*v);w=m*d-l;P=m*h-c;B=m*g-u;k=y*f-l;S=y*M-c;L=y*v-u;b=(k*w+S*P+L*B)/(Math.sqrt(k*k+S*S+L*L)*Math.sqrt(w*w+P*P+B*B));b=Math.acos(b);C=S*B-L*P;G=0-(k*B-L*w);W=k*P-S*w;if(l!=0){A=C/l}else{if(c!=0){A=G/c}else{A=W/u}}if(A>0){I+=b;E++}else{x+=b;D++}}var K,j;K=I+(2*Math.PI*D-x);j=2*Math.PI*E-I+x;if(I>x){if(K-(O-2)*Math.PI<1){_=K}else{_=j}}else{if(j-(O-2)*Math.PI<1){_=j}else{_=K}}a=(_-(O-2)*Math.PI)*z*z;return a};return t};e.prototype.isBaiduPointOnChina=function(t,e){var a=CreateChinaMapLine();var n=new BMap.Polygon(a);var r=new BMap.Point(t,e);if(!this.BMapLib){this.BMapLib=this.getOnChina()}var o=this.BMapLib.GeoUtils.isPointInPolygon(r,n);return o};function a(t){var e=this;var a={lat:22.581783,lng:113.962135,idVal:"googoleMap",oAddressInput:false,isStillMarker:false,isModuleLoad:false,lang:"en",isPlaceSugSearch:false,mapKey:googleMapKey,callback:function(){}};const n=Object.assign({},a,t);this.firstLat=n.lat;this.firstLng=n.lng;this.firstAddr="";var r=coordTrans.gcj_encrypt(n.lat,n.lng);n.lat=r.lat;n.lng=r.lng;this.callback=n.callback;this.lat=n.lat;this.lng=n.lng;this.idVal=n.idVal;this.oAddressInput=n.oAddressInput;this.isStillMarker=n.isStillMarker;this.isPlaceSugSearch=n.isPlaceSugSearch;this.lang=n.lang;this.mapKey=n.mapKey;this.isChina=true;this.postal_code="";this.detailsAddress="";this.city="";this.country="";this.provice="";this.map=null;this.infowindow=null;this.geocoder=null;this.marker=null;this.placeSugSearchMarker=null;this.markerClusterer=null;this.clustererMarkerList=[];this.languageList=[{code:"zh-CN",txt:"中文",ServerKey:"cn",OSSKey:"cn",text:"中文"},{code:"zh-HK",txt:"中文（香港）",ServerKey:"hk",OSSKey:"ft",text:"繁體中文"},{code:"ja",txt:"日语",ServerKey:"ja",OSSKey:"",text:"日本語"},{code:"en",txt:"英语",ServerKey:"",OSSKey:"en",text:"English"},{code:"cs",txt:"捷克语",ServerKey:"jk",OSSKey:"jk",text:"Česky"},{code:"da",txt:"丹麦语",ServerKey:"",OSSKey:"",text:""},{code:"fi",txt:"芬兰语",ServerKey:"",OSSKey:"",text:""},{code:"fr",txt:"法语",ServerKey:"",OSSKey:"",text:""},{code:"fil",txt:"菲律宾语",ServerKey:"",OSSKey:"",text:""},{code:"ar",txt:"阿拉伯语",ServerKey:"",OSSKey:"",text:""},{code:"de",txt:"德语",ServerKey:"gm",OSSKey:"gm",text:"German"},{code:"el",txt:"希腊语",ServerKey:"gk",OSSKey:"",text:"Greek"},{code:"hu",txt:"匈牙利语",ServerKey:"",OSSKey:"",text:""},{code:"it",txt:"意大利语",ServerKey:"it",OSSKey:"it",text:"Italiano"},{code:"ko",txt:"韩语",ServerKey:"kr",OSSKey:"",text:"한국어"},{code:"no",txt:"挪威语",ServerKey:"",OSSKey:"",text:""},{code:"pl",txt:"波兰语",ServerKey:"pl",OSSKey:"pl",text:"Polish"},{code:"pt",txt:"葡萄牙语",ServerKey:"pt",OSSKey:"pt",text:"Português"},{code:"ru",txt:"俄语",ServerKey:"",OSSKey:"",text:""},{code:"es",txt:"西班牙语",ServerKey:"sp",OSSKey:"",text:"Español"},{code:"sv",txt:"瑞典语",ServerKey:"",OSSKey:"",text:""},{code:"th",txt:"泰语",ServerKey:"th",OSSKey:"",text:"ไทย"},{code:"tr",txt:"土耳其语",ServerKey:"tk",OSSKey:"",text:"Türkçe"},{code:"vi",txt:"越南语",ServerKey:"vn",OSSKey:"",text:"Vietnamese"},{code:"ro",txt:"罗马尼亚语",ServerKey:"lmny",OSSKey:"",text:"Română"},{code:"nl",txt:"荷兰语",ServerKey:"ho",OSSKey:"",text:"Nederland"}];this.drawingManager=null;if(n.isModuleLoad){this.renderGoogleMap(this.lat,this.lng,this.idVal,function(){e.addMarker(e.isStillMarker)})}else{this.xhbLoadGMap({lat:this.lat,lng:this.lng},this.idVal)}}a.prototype.sanctionCountry=function(t,a){var n=this;var e=false;for(var r=0;r<sanctionCountryList.length;r++){if(t.indexOf(sanctionCountryList[r])>=0){e=true}}if(e){this.getLnglatByAddress(t,function(t){if(t.info=="OK"){var e=coordTrans.outOfChina(t.lnglat.lat,t.lnglat.lng);if(e){n.updateMarkerWindow(n.firstAddr,n.firstLat,n.firstLng);if(window.layer){layer.msg("Currently not supported, please select again")}else{alert("Currently not supported, please select again")}}a&&a(e)}else{console.error("地址解析失败");a&&a(false)}})}else{a&&a(false)}};a.prototype.getLnglatByAddress=function(t,n){var e=this;this.geocoder.geocode({address:t}).then(t=>{const{results:e}=t;var a=e[0].geometry.location;if(a){var t={lnglat:{lat:a.lat(),lng:a.lng()},info:"OK"}}else{var t={info:"error"}}n&&n(t)}).catch(t=>{})};a.prototype.get_cookie=function(t){var e,a=new RegExp("(^| )"+t+"=([^;]*)(;|$)");if(e=document.cookie.match(a))return unescape(e[2]);else return null};a.prototype.xhbLoadGMap=function(t,e,a){var n=this;var r=Date.parse(new Date);var o=this.get_cookie("lang");var i="&language="+this.lang;var s="&libraries=places,drawing";var p=[location.protocol+"//maps.googleapis.com/maps/api/js?key="+this.mapKey+"&t="+r+i+s];if(window.google){google.maps.event.addDomListener(window,"load",n.renderGoogleMap(n.lat,n.lng,n.idVal,function(){n.addMarker(n.isStillMarker)}))}else{loadScript(p,0,function(){google.maps.event.addDomListener(window,"load",n.renderGoogleMap(n.lat,n.lng,n.idVal,function(){n.addMarker(n.isStillMarker)}))})}};a.prototype.createInfoWindow=function(t,e){const a=new google.maps.InfoWindow;a.setContent(t);a.open(this.map,e)};a.prototype.initMarkerClusterer=function(t,o,i,e){var s=this;const a=t.map(function(t,a){var e=coordTrans.gcj_encrypt(t.lat,t.lng);const n=new google.maps.Marker({position:e});const r=new google.maps.InfoWindow({content:"",disableAutoPan:true});r.setContent(o[a]);r.open(s.map,n);n.addListener("click",(t,e)=>{i&&i(a,t,n)});s.clustererMarkerList.push(n);return n});var n=new google.maps.LatLng(t[0].lat,t[0].lng);this.map.setCenter(n);this.map.setZoom(2);if(window.markerClusterer){this.markerClusterer=new markerClusterer.MarkerClusterer({markers:a,map:this.map});return this.markerClusterer}else{if(e){this.markerClusterer=new e.MarkerClusterer({markers:a,map:this.map});return this.markerClusterer}else{alert("请引入谷歌地图标注聚合功能插件脚本才能使用标注聚合功能")}}};a.prototype.addMarkerClusterer=function(t,o,i){if(!this.markerClusterer){return alert("请先使用 initMarkerClusterer 函数初始化标注聚合器功能")}var s=this;const e=t.map(function(t,a){var e=coordTrans.gcj_encrypt(t.lat,t.lng);const n=new google.maps.Marker({position:e});const r=new google.maps.InfoWindow({content:"",disableAutoPan:true});r.setContent(o[a]);r.open(s.map,n);n.addListener("click",(t,e)=>{i&&i(a,t)});s.clustererMarkerList.push(n);return n});this.markerClusterer.addMarkers(e);var a=new google.maps.LatLng(t[0].lat,t[0].lng);this.map.setCenter(a);this.map.setZoom(2)};a.prototype.updateMarkerClusterer=function(t,e,a){this.markerClusterer.clearMarkers();this.clustererMarkerList=[];this.addMarkerClusterer(t,e,a)};a.prototype.delMarkerClusterer=function(t){if(this.clustererMarkerList.length&&this.markerClusterer){this.markerClusterer.removeMarker(this.clustererMarkerList[t]);this.clustererMarkerList.splice(t,1)}};a.prototype.renderGoogleMap=function(t,e,a,n){var r=this;this.infowindow=new google.maps.InfoWindow({content:"Search...",size:new google.maps.Size(50,50)});this.geocoder=new google.maps.Geocoder;var o=new google.maps.LatLng(t,e);var i={center:o,zoom:17,draggable:true,mapTypeId:google.maps.MapTypeId.ROADMAP,scaleControl:true};this.map=new google.maps.Map(document.getElementById(a),i);google.maps.event.trigger(this.map,"resize");if(this.oAddressInput){if(this.isPlaceSugSearch){this.placeSugSearch(this.oAddressInput,true)}else{this.oAddressInput.onblur=function(){var e=this.value;if(e=="")return false;r.sanctionCountry(e,function(t){if(!t){r.getGEOInfoByAddr(e,function(){})}})}}}n&&n()};a.prototype.rotate90=function(){var e=this;if(this.map.getTilt()!==0){window.setInterval(function(){const t=e.map.getHeading()||0;e.map.setHeading(t+90)},3e3)}};a.prototype.addressComponentsFn=function(t){var e={city:"",provice:"",country:"",postal_code:""};for(var a=0;a<t.length;a++){n(t[a])}function n(t){if(t.types.includes("postal_code")){e.postal_code=t.long_name}if(t.types.includes("country")){e.country=t.long_name}if(t.types.includes("administrative_area_level_1")){e.provice=t.long_name}if(t.types.includes("locality")){e.city=t.long_name}}return e};a.prototype.placeSugSearch=function(i,s){var p=this;var l=new google.maps.places.SearchBox(i);l.addListener("places_changed",function(t,e){var a=l.getPlaces();var n=a[0].name;var r=a[0].formatted_address;i.value=n;i.setAttribute("place-id",a[0].place_id);var o=a[0].geometry.location;if(s){p.getInfoByLatLng(o,function(t){p.detailsAddress="【"+n+"】"+r;t.detailsAddress=p.detailsAddress;p.setMarkerAddress(t);p.marker.setPosition(o)})}else{if(p.placeSugSearchMarker)p.placeSugSearchMarker.setMap(null);p.placeSugSearchMarker=p.diyMarker({icon:"https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png",position:{lat:o.lat(),lng:o.lng()},title:a[0].name,zIndex:100})}p.map.setCenter(o)});this.map.addListener("bounds_changed",()=>{l.setBounds(this.map.getBounds())})};a.prototype.getAddrDetailsInfoByPlaceId=function(t,e,a){var n=new google.maps.places.PlacesService(t);n.getDetails({placeId:e},function(t,e){a&&a(t,e)})};a.prototype.diyMarker=function(t){var e=this;var a={position:t.lanlng||{lat:e.lat,lng:e.lng},map:e.map,icon:t.image||null,title:t.title||"",zIndex:t.zIndex||1};var n=Object.assign({},a,t);var r=new google.maps.Marker(n);this.createInfoWindow(n.title,r);return r};a.prototype.addMarker=function(t,e,a){var n=document.getElementsByTagName("head")[0];var r=document.createElement("style");r.setAttribute("type","text/css");r.innerHTML=".gm-ui-hover-effect{display: none !important;}";n.appendChild(r);var o=this;if(e===l&&a===l){e=this.lat;a=this.lng}var i=new google.maps.LatLng(e,a);this.marker=new google.maps.Marker({position:i,draggable:!t});this.marker.setMap(this.map);this.getInfoByLatLng(i,function(t){o.setMarkerAddress(t);o.firstAddr=t.detailsAddress});google.maps.event.addListener(o.marker,"dragstart",function(){o.updateMarkerAddress("searching...")});google.maps.event.addListener(o.marker,"dragend",function(t,e){o.getInfoByLatLng(o.marker.getPosition(),function(t){o.map.setCenter(o.marker.getPosition());o.setMarkerAddress(t)})});this.callback()};a.prototype.getInfoByLatLng=function(r,o){var p=this;var i=["中国","china","China","中國","中华人民共和国","中華人民共和國","zhongguo","zhonghuarenmingongheguo"];this.geocoder.geocode({latLng:r},function(t){if(t&&t.length>0){p.lat=r.lat();p.lng=r.lng();var a=s(t,r);function n(t){p.postal_code=t.postal_code;p.detailsAddress=t.detailsAddress;p.country=t.country;p.provice=t.provice;p.city=t.city;o&&o(t)}var e=a.country.toLowerCase();if(i.includes(e)){n(a)}else{getLatLngInfoByGDWebServer({location:{lat:r.lat(),lng:r.lng()}},function(t){if(t.info=="OK"){var e=t.regeocode.addressComponent;a.detailsAddress=t.regeocode.formatted_address;a.country=e.country;a.provice=e.province;a.city=e.city.length===0?e.province:e.city;n(a)}else{n(a)}})}}else{o&&o(false)}});function s(t,e){var a=[];for(var n=0;n<t.length;n++){a.push(t[n].address_components.length)}var r=a.indexOf(Math.max(...a));var o=t[r];var i=p.addressComponentsFn(o.address_components);var s={lat:e.lat(),lng:e.lng(),coordinates:e.lat()+","+e.lng(),detailsAddress:t[r].formatted_address,postal_code:i.postal_code,country:i.country,provice:i.provice,city:i.city};return s}};a.prototype.setMarkerAddress=function(e){var a=this;if(e){this.sanctionCountry(e.detailsAddress,function(t){if(!t)a.updateMarkerAddress(e.detailsAddress)})}else{this.updateMarkerAddress("Unable to determine the address at this location.")}};a.prototype.updateMarkerAddress=function(t){this.infowindow.setContent(t);this.infowindow.open(this.map,this.marker);if(this.oAddressInput){this.oAddressInput.value=t}};a.prototype.updateMarkerWindow=function(t,e,a){var n=this;if(!this.marker||!this.geocoder){window.updateMarkerWindow_fn_timer=setTimeout(function(){n.updateMarkerWindow(t,e,a)},1e3)}else{window.clearTimeout(window.updateMarkerWindow_fn_timer);var r=coordTrans.gcj_encrypt(e,a);e=r.lat;a=r.lng;var o=new google.maps.LatLng(e,a);this.map.setCenter(o);this.marker.setPosition(o);this.getInfoByLatLng(o,function(){n.updateMarkerAddress(t||n.detailsAddress)})}};a.prototype.getStaticMapImage=function(t,e){t=t||this.lat;e=e||this.lng;var a="https://maps.googleapis.com/maps/api/staticmap?center="+t+","+e+"&maptype=satellite&zoom=19&scale=2&size=640x640&format=jpg-baseline&key="+this.mapKey;return a};a.prototype.getGEOInfoByAddr=function(n,r){var o=this;if(n==o.detailsAddress)return;this.geocoder.geocode({address:n}).then(t=>{const{results:e}=t;o.map.setCenter(e[0].geometry.location);o.marker.setPosition(e[0].geometry.location);o.updateMarkerAddress(n);var a=new google.maps.LatLng(e[0].geometry.location.lat(),e[0].geometry.location.lng());o.getInfoByLatLng(a);r&&r(e)}).catch(t=>{})};a.prototype.initDrawingManager=function(){this.drawingManager=new google.maps.drawing.DrawingManager({drawingMode:google.maps.drawing.OverlayType.MARKER,drawingControl:true,drawingControlOptions:{position:google.maps.ControlPosition.TOP_CENTER,drawingModes:[google.maps.drawing.OverlayType.MARKER,google.maps.drawing.OverlayType.CIRCLE,google.maps.drawing.OverlayType.POLYGON,google.maps.drawing.OverlayType.POLYLINE,google.maps.drawing.OverlayType.RECTANGLE]},markerOptions:{icon:"https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png"},circleOptions:{fillColor:"#ffff00",fillOpacity:.5,strokeWeight:5,clickable:false,editable:true,zIndex:1}});this.drawingManager.setMap(this.map)};a.prototype.getPlaceNearbySearch=function(t,n){var e=this;var a=new google.maps.LatLng(this.lat,this.lng);var r={location:a,radius:500,type:"store"};var o=Object.assign({},r,t);var i=new google.maps.places.PlacesService(this.map);i.nearbySearch(o,(t,e,a)=>{if(e!=="OK"||!t){alert("周边没有找到指定类型的地址");return}n&&n(t)})};a.prototype.getCurrCoordByWGS84=function(t,e){t=t||this.lat;e=e||this.lng;return coordTrans.getWGS84({lat:t,lng:e},"google")};function n(t){var e=this;if(t.mapKey&&!t.jsCode||!t.mapKey&&t.jsCode){alert("高德地图秘钥,和对应的安全密钥必须一同传参才可使用");return}var a={lat:22.581783,lng:113.962135,idVal:"gaodeMap",isModuleLoad:false,oAddressInput:false,isStillMarker:false,isPlaceSugSearch:false,mapKey:gaodeMapKey,jsCode:gaodeJsCode,lang:"zh_cn",plugin:["AMap.ToolBar","AMap.CustomLayer","AMap.Scale","AMap.MapType","AMap.Geolocation","AMap.Autocomplete","AMap.PlaceSearch","AMap.MarkerClusterer"],callback:function(){}};const n=Object.assign({},a,t);this.firstLat=n.lat;this.firstLng=n.lng;this.firstAddr="";var r=coordTrans.gcj_encrypt(n.lat,n.lng);n.lat=r.lat;n.lng=r.lng;this.callback=n.callback;this.lat=n.lat;this.lng=n.lng;this.idVal=n.idVal;this.lang=n.lang;this.isModuleLoad=n.isModuleLoad;this.oAddressInput=n.oAddressInput;this.isStillMarker=n.isStillMarker;this.isPlaceSugSearch=n.isPlaceSugSearch;this.mapKey=n.mapKey;this.jsCode=n.jsCode;this.plugin=n.plugin;this.isChina=true;this.postal_code="";this.detailsAddress="";this.city="";this.country="";this.provice="";this.map=null;this.infowindow=null;this.geocoder=null;this.autocomplete=null;this.placeSearch=null;this.marker=null;this.placeSugSearchMarker=null;this.markerClusterer=null;this.clustererMarkerList=[];var o=document.getElementsByTagName("head")[0];var i=document.createElement("style");i.innerHTML=".amap-marker-label{border-radius: 3px;border: 1px solid #c9c9c9;}";o.append(i);window._AMapSecurityConfig={securityJsCode:e.jsCode};if(n.isModuleLoad){e.renderMap(e.lat,e.lng,e.idVal,function(){e.callback()})}else{this.xhbLoadGMap({lat:this.lat,lng:this.lng},this.idVal,function(){})}}n.prototype.xhbLoadGMap=function(t,e,a){var n=this;var r=Date.parse(new Date);var o="";var i=[location.protocol+"//webapi.amap.com/maps?v=1.4.15&key="+this.mapKey+o];if(window.AMap){n.renderMap(n.lat,n.lng,n.idVal,function(){n.callback()})}else{loadScript(i,0,function(){n.renderMap(n.lat,n.lng,n.idVal,function(){n.callback()})})}};n.prototype.renderMap=function(n,r,t,e){var o=this;this.map=new AMap.Map(t,{center:[r,n],zoom:17,dragEnable:true,viewMode:"2D",lang:this.lang});this.map.on("complete",function(){AMap.plugin(["AMap.ToolBar","AMap.CustomLayer","AMap.Scale","AMap.MapType","AMap.Geolocation","AMap.Autocomplete","AMap.PlaceSearch","AMap.Geocoder"],function(){var t=new AMap.ToolBar;var e=new AMap.Scale;var a=new AMap.MapType;o.map.addControl(t);o.map.addControl(e);o.geocoder=new AMap.Geocoder({});o.setDefaultMarker(r,n,function(){var t=new AMap.LngLat(r,n);o.getInfoByLatLng(t,function(t){o.updateMarkerAddress(o.detailsAddress)})})});if(o.oAddressInput){if(o.isPlaceSugSearch){o.placeSugSearch(o.oAddressInput,true)}else{o.oAddressInput.onblur=function(){var e=this.value;if(e=="")return false;o.sanctionCountry(e,function(t){if(!t){o.getGEOInfoByAddr(e)}})}}}e&&e()})};n.prototype.getLocationListToMarkerClusterer=function(t,e,r){var o=this;const a=t.map(function(t,a){var n=o.addMarker({lat:t.lat,lng:t.lng});n.setLabel(o.setLabel(e[a]));n.on("click",(t,e)=>{r&&r(a,t,n)});o.clustererMarkerList.push(n);return n});return a};n.prototype.initMarkerClusterer=function(t,e,n,a){var r=this;const o=this.getLocationListToMarkerClusterer(t,e,function(t,e,a){n&&n(t,e,a)});var i=new AMap.LngLat(t[0].lng,t[0].lat);this.map.setCenter(i);this.map.setZoom(2);this.map.plugin(["AMap.MarkerClusterer"],function(){r.markerClusterer=new AMap.MarkerClusterer(r.map,o,a||l)});return this.markerClusterer};n.prototype.addMarkerClusterer=function(t,e,n){if(!this.markerClusterer){return alert("请先使用 initMarkerClusterer 函数初始化标注聚合器功能")}var a=this;const r=this.getLocationListToMarkerClusterer(t,e,function(t,e,a){n&&n(t,e,a)});this.markerClusterer.addMarkers(r);var o=new AMap.LngLat(t[0].lng,t[0].lat);this.map.setCenter(o);this.map.setZoom(2)};n.prototype.updateMarkerClusterer=function(t,e,n){if(!this.markerClusterer){return alert("请先使用 initMarkerClusterer 函数初始化标注聚合器功能")}var a=this;this.clustererMarkerList=[];const r=this.getLocationListToMarkerClusterer(t,e,function(t,e,a){n&&n(t,e,a)});this.markerClusterer.setMarkers(r)};n.prototype.delMarkerClusterer=function(t){if(this.clustererMarkerList.length&&this.markerClusterer){this.markerClusterer.removeMarker(this.clustererMarkerList[t]);this.clustererMarkerList.splice(t,1)}};n.prototype.getCurrCoordByWGS84=function(t,e){t=t||this.lat;e=e||this.lng;return coordTrans.getWGS84({lat:t,lng:e},"gaode")};n.prototype.getStaticMapImage=function(t,e){var a=this.marker.getPosition();t=t||this.lat;e=e||this.lng;var n="https://restapi.amap.com/v3/staticmap?key=74534047360c79e9a712cf1590fed66b&location="+e+","+t+"&size=1000*1000&zoom=17&markers=mid,0xFF0000,A:"+e+","+t;return n};n.prototype.setLabel=function(t){var e={offset:new AMap.Pixel(0,0),content:"<div style='padding:2px 5px;'>"+t+"</div>",direction:"top"};return e};n.prototype.getLnglatByAddress=function(t,a){var e=this;this.geocoder.getLocation(t,function(t,e){if(t==="complete"&&e.info==="OK"){a&&a(e)}else{var e={info:"error"};a&&a(e)}})};n.prototype.getGEOInfoByAddr=function(n,r){var o=this;if(n==o.detailsAddress)return;this.geocoder.getLocation(n,function(t,e){if(t==="complete"&&e.info==="OK"){var a=e.geocodes[0];o.map.setCenter(a.location);o.marker.setPosition(a.location);o.updateMarkerAddress(n);o.getInfoByLatLng(a.location);r&&r(results)}})};n.prototype.placeSugSearch=function(t,a){var n=this;this.autocomplete=new AMap.Autocomplete({input:t.getAttribute("id")});this.placeSearch=new AMap.PlaceSearch({map:this.map});AMap.event.addListener(this.autocomplete,"select",function(t){if(a){var e=t.poi.location;n.map.setCenter(e);n.marker.setPosition(e);n.getInfoByLatLng(e,function(){n.detailsAddress="【"+t.poi.name+"】"+n.detailsAddress;n.updateMarkerAddress(n.detailsAddress)})}else{n.placeSearch.search(t.poi.name)}})};n.prototype.addMarker=function(t,e){var a=coordTrans.gcj_encrypt(t.lat,t.lng);if(e)e.position=[a.lng,a.lat];var n=new AMap.Marker(e||{icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[a.lng,a.lat]});this.map.add(n);return n};n.prototype.setDefaultMarker=function(t,e,a){var n=this;n.marker=new AMap.Marker({icon:"https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png",position:[t,e]});if(!n.isStillMarker){n.marker.setDraggable(true);n.marker.setClickable(true)}n.marker.setLabel(n.setLabel("加载中..."));n.marker.on("dragend",function(t){var e=n.marker.getPosition();n.getInfoByLatLng(e,function(){n.updateMarkerAddress(n.detailsAddress);n.map.setCenter(e)})});n.map.add(n.marker);a&&a();return n.marker};n.prototype.getInfoByLatLng=function(n,r){var o=this;var t=[n.lng,n.lat];this.geocoder.getAddress(n,function(t,a){if(t=="no_data"){window.layer?window.layer.alert(gaodeNodataText):alert(gaodeNodataText);o.updateMarkerWindow(o.firstAddr,o.firstLat,o.firstLng);return}if(t==="complete"&&a.info==="OK"){o.sanctionCountry(a.regeocode.formattedAddress,function(t){if(t)return;var e=a.regeocode.addressComponent;o.city=e.city;o.country=e.country;o.provice=e.province;o.detailsAddress=a.regeocode.formattedAddress;o.lat=n.lat;o.lng=n.lng;r&&r(a.regeocode)})}})};n.prototype.sanctionCountry=function(t,n){var r=this;var e=false;for(var a=0;a<sanctionCountryList.length;a++){if(t.indexOf(sanctionCountryList[a])>=0){e=true}}if(e){this.getLnglatByAddress(t,function(t){if(t.info=="OK"){var e=t.geocodes[0];var a=coordTrans.outOfChina(e.location.lat,e.location.lng);if(a){r.updateMarkerWindow(r.firstAddr,r.firstLat,r.firstLng);if(window.layer){layer.msg(notSupportText)}else{alert(notSupportText)}}n&&n(a)}else{console.error("地址解析失败");n&&n(false)}})}else{n&&n(false)}};n.prototype.updateMarkerWindow=function(t,e,a){var n=this;if(!this.marker||!this.geocoder){window.updateMarkerWindow_fn_timer=setTimeout(function(){n.updateMarkerWindow(t,e,a)},1e3)}else{window.clearTimeout(window.updateMarkerWindow_fn_timer);var r=coordTrans.gcj_encrypt(e,a);e=r.lat;a=r.lng;var o=new AMap.LngLat(a,e);this.map.setCenter(o);this.marker.setPosition(o);this.getInfoByLatLng(o,function(){n.updateMarkerAddress(t||n.detailsAddress)})}};n.prototype.updateMarkerAddress=function(t){var e=this;e.marker.setLabel(e.setLabel(t));if(this.oAddressInput){this.oAddressInput.value=t}};n.prototype.destroy=function(t){t?t.destroy():this.map.destroy()};var r={coordTrans:coordTrans,baiduMap:o,loadBaiduMap:e,loadGoogleMap:a,loadGaodeMap:n,getLatLogByLocalhost:getLatLogByLocalhost,loadScript:loadScript,promiseAjax:promiseAjax,jsonp:jsonp,sanctionCountryList:sanctionCountryList,getLatLngInfoByBDWebServer:getLatLngInfoByBDWebServer,getLatLngInfoByGDWebServer:getLatLngInfoByGDWebServer};t=function(){return this||(0,eval)("this")}();if(typeof module!=="undefined"&&module.exports){module.exports=r}else if(typeof define==="function"&&define.amd){define(function(){return r})}else{!("XHBMap"in t)&&(t.XHBMap=r)}})();